# üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

## –û–±–∑–æ—Ä

–í—Å–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Å—Ü–µ–Ω—ã, NPC, —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã) —Ç–µ–ø–µ—Ä—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏**.

## –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

### ‚ùå –†–∞–Ω—å—à–µ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ –≤–∞–∫—É—É–º–µ):
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–°–æ–∑–¥–∞–π NPC - —Ç–∞–≤–µ—Ä—â–∏–∫"
AI: –°–æ–∑–¥–∞–µ—Ç –æ–±—ã—á–Ω–æ–≥–æ —Ç–∞–≤–µ—Ä—â–∏–∫–∞ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–∞–º–ø–∞–Ω–∏–∏
```

### ‚úÖ –¢–µ–ø–µ—Ä—å (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è):
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–°–æ–∑–¥–∞–π NPC - —Ç–∞–≤–µ—Ä—â–∏–∫" –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏ "–ü—Ä–æ–∫–ª—è—Ç–∏–µ –ö–æ—Å—Ç—è–Ω–æ–π –ë–∞—à–Ω–∏"

AI –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç:
- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏: "–ü—Ä–æ–∫–ª—è—Ç–∏–µ –ö–æ—Å—Ç—è–Ω–æ–π –ë–∞—à–Ω–∏"
- –°—é–∂–µ—Ç: "–î—Ä–µ–≤–Ω–∏–π –ª–∏—á –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è..."
- –°–µ—Ç—Ç–∏–Ω–≥: Forgotten Realms
- –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: "–ú—Ä–∞—á–Ω–∞—è –≥–æ—Ç–∏–∫–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —É–∂–∞—Å–∞"
- –ê–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç: –ú–∞–ª–∫–∞—Ä–æ—Ç –õ–∏—á–Ω–µ–µ–¥

AI —Å–æ–∑–¥–∞–µ—Ç:
–¢–∞–≤–µ—Ä—â–∏–∫ –ë–æ—Ä–∏—Å, –∫–æ—Ç–æ—Ä—ã–π:
- –†–∞–Ω—å—à–µ –±—ã–ª —É—á–µ–Ω–∏–∫–æ–º –∞—Ä—Ö–∏–º–∞–≥–∞
- –ó–Ω–∞–µ—Ç —Å–ª—É—Ö–∏ –æ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–∏ –ª–∏—á–∞
- –ú–æ–∂–µ—Ç –¥–∞—Ç—å –∑–∞—Ü–µ–ø–∫—É –Ω–∞ –∫–≤–µ—Å—Ç
- –û–ø–∏—Å–∞–Ω –≤ –≥–æ—Ç–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ
```

---

## –ö–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç

### 1. POST `/api/generate/scene` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω—ã

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- ‚úÖ –°–∏–Ω–æ–ø—Å–∏—Å (—Å—é–∂–µ—Ç)
- ‚úÖ –°–µ—Ç—Ç–∏–Ω–≥
- ‚úÖ –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
- ‚úÖ –¢–µ–º—ã –∫–∞–º–ø–∞–Ω–∏–∏

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:**
```
–ö–û–ù–¢–ï–ö–°–¢ –ö–ê–ú–ü–ê–ù–ò–ò:
–ù–∞–∑–≤–∞–Ω–∏–µ: –ü—Ä–æ–∫–ª—è—Ç–∏–µ –ö–æ—Å—Ç—è–Ω–æ–π –ë–∞—à–Ω–∏
–°—é–∂–µ—Ç: –î—Ä–µ–≤–Ω–∏–π –ª–∏—á –ú–∞–ª–∫–∞—Ä–æ—Ç –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ–∫–ª—è—Ç–∏–µ –Ω–∞ –≥–µ—Ä–æ–µ–≤...
–°–µ—Ç—Ç–∏–Ω–≥: Forgotten Realms
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: –ú—Ä–∞—á–Ω–∞—è –≥–æ—Ç–∏–∫–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —É–∂–∞—Å–∞
–¢–µ–º—ã: –í—ã–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–º–µ–Ω–∏, –ò—Å–∫—É–ø–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∂–µ—Ä—Ç–≤—É

–ù–û–í–ê–Ø –°–¶–ï–ù–ê:
–ì–µ—Ä–æ–∏ –≤—Ö–æ–¥—è—Ç –≤ –∑–∞–±—Ä–æ—à–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É

–°–æ–∑–¥–∞–π —Å—Ü–µ–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ—Ç —Å—é–∂–µ—Ç –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.
```

---

### 2. POST `/api/generate/npc` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è NPC

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- ‚úÖ –°–∏–Ω–æ–ø—Å–∏—Å (—Å—é–∂–µ—Ç)
- ‚úÖ –°–µ—Ç—Ç–∏–Ω–≥
- ‚úÖ –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
- ‚úÖ –ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:**
```
–ö–û–ù–¢–ï–ö–°–¢ –ö–ê–ú–ü–ê–ù–ò–ò:
–ù–∞–∑–≤–∞–Ω–∏–µ: –ü—Ä–æ–∫–ª—è—Ç–∏–µ –ö–æ—Å—Ç—è–Ω–æ–π –ë–∞—à–Ω–∏
–°—é–∂–µ—Ç: –î—Ä–µ–≤–Ω–∏–π –ª–∏—á –ú–∞–ª–∫–∞—Ä–æ—Ç –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ–∫–ª—è—Ç–∏–µ –Ω–∞ –≥–µ—Ä–æ–µ–≤...
–°–µ—Ç—Ç–∏–Ω–≥: Forgotten Realms
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: –ú—Ä–∞—á–Ω–∞—è –≥–æ—Ç–∏–∫–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —É–∂–∞—Å–∞
–ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç: –ú–∞–ª–∫–∞—Ä–æ—Ç –õ–∏—á–Ω–µ–µ–¥ - –î—Ä–µ–≤–Ω–∏–π –ª–∏—á, –±—ã–≤—à–∏–π –∞—Ä—Ö–∏–º–∞–≥

–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö NPC:
–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–≤–µ—Ä—â–∏–∫–∞ –¥–ª—è –º–µ—Å—Ç–Ω–æ–π —Ç–∞–≤–µ—Ä–Ω—ã

–ü–µ—Ä—Å–æ–Ω–∞–∂ –¥–æ–ª–∂–µ–Ω –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ —Å—é–∂–µ—Ç –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∫–∞–º–ø–∞–Ω–∏–∏.
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
AI —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–≤–µ—Ä—â–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π:
- –ú–æ–∂–µ—Ç –∑–Ω–∞—Ç—å —Å–ª—É—Ö–∏ –æ –ª–∏—á–µ
- –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Å—Ç—Ä–∞–¥–∞–ª –æ—Ç –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏–π –≤ –ø—Ä–æ—à–ª–æ–º
- –û–ø–∏—Å–∞–Ω –≤ –≥–æ—Ç–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ
- –ò–º–µ–µ—Ç —Å–≤—è–∑—å —Å —Å—é–∂–µ—Ç–æ–º

---

### 3. POST `/api/generate/encounter` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–∞

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- ‚úÖ –°–∏–Ω–æ–ø—Å–∏—Å (—Å—é–∂–µ—Ç)
- ‚úÖ –°–µ—Ç—Ç–∏–Ω–≥
- ‚úÖ –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
- ‚úÖ –ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
- ‚úÖ –ö–ª—é—á–µ–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∫–∞–º–ø–∞–Ω–∏–∏)

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:**
```
–ö–û–ù–¢–ï–ö–°–¢ –ö–ê–ú–ü–ê–ù–ò–ò:
–ù–∞–∑–≤–∞–Ω–∏–µ: –ü—Ä–æ–∫–ª—è—Ç–∏–µ –ö–æ—Å—Ç—è–Ω–æ–π –ë–∞—à–Ω–∏
–°—é–∂–µ—Ç: –î—Ä–µ–≤–Ω–∏–π –ª–∏—á –ú–∞–ª–∫–∞—Ä–æ—Ç –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ–∫–ª—è—Ç–∏–µ –Ω–∞ –≥–µ—Ä–æ–µ–≤...
–°–µ—Ç—Ç–∏–Ω–≥: Forgotten Realms
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: –ú—Ä–∞—á–Ω–∞—è –≥–æ—Ç–∏–∫–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —É–∂–∞—Å–∞
–ì–ª–∞–≤–Ω—ã–π –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç: –ú–∞–ª–∫–∞—Ä–æ—Ç –õ–∏—á–Ω–µ–µ–¥
–ö–ª—é—á–µ–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏: –£–æ—Ç–µ—Ä–¥–∏–ø, –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ö–∞–Ω–¥–ª–∫–∏–ø, –†—É–∏–Ω—ã –ú–∞–ª–∫–∞—Ä–æ—Ç–∞

–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –≠–ù–ö–ê–£–ù–¢–ï–†–£:
–°–æ–∑–¥–∞–π—Ç–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä –≤ –¥—Ä–µ–≤–Ω–∏—Ö —Ä—É–∏–Ω–∞—Ö

–≠–Ω–∫–∞—É–Ω—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—é–∂–µ—Ç—É –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –∫–∞–º–ø–∞–Ω–∏–∏.
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
AI —Å–æ–∑–¥–∞—Å—Ç —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä —Å:
- –í—Ä–∞–≥–∞–º–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å –ª–∏—á–µ–º (—Å–∫–µ–ª–µ—Ç—ã, –∑–æ–º–±–∏, –ø—Ä–∏–∑—Ä–∞–∫–∏)
- –ì–æ—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –ª–æ–∫–∞—Ü–∏–∏
- –≠–ª–µ–º–µ–Ω—Ç–∞–º–∏, –ø—Ä–æ–¥–≤–∏–≥–∞—é—â–∏–º–∏ —Å—é–∂–µ—Ç
- –ü–æ–¥—Ö–æ–¥—è—â–∏–º —É—Ä–æ–≤–Ω–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:

```typescript
1. –ü–æ–ª—É—á–∏—Ç—å projectId –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ –ë–î: prisma.project.findUnique()
3. –ò–∑–≤–ª–µ—á—å –¥–µ—Ç–∞–ª–∏ –∏–∑ project.description (JSON)
4. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å enrichedContext —Å:
   - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
   - –°–∏–Ω–æ–ø—Å–∏—Å
   - –°–µ—Ç—Ç–∏–Ω–≥
   - –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞
   - –¢–µ–º—ã
   - –ê–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç
   - –õ–æ–∫–∞—Ü–∏–∏
5. –ü–µ—Ä–µ–¥–∞—Ç—å enrichedContext –≤ –ø—Ä–æ–º–ø—Ç LLM
6. LLM —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —Å —É—á–µ—Ç–æ–º –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (scene/route.ts):

```typescript
// –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–µ–∫—Ç –∏–∑ –ë–î –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const project = await prisma.project.findUnique({
  where: { id: projectId },
});

// –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞
let projectDetails;
try {
  projectDetails = JSON.parse(project.description || '{}');
} catch (e) {
  projectDetails = {};
}

// –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞–º–ø–∞–Ω–∏–∏
const enrichedContext = `
–ö–û–ù–¢–ï–ö–°–¢ –ö–ê–ú–ü–ê–ù–ò–ò:
–ù–∞–∑–≤–∞–Ω–∏–µ: ${project.title}
–°—é–∂–µ—Ç: ${project.synopsis || '–Ω–µ —É–∫–∞–∑–∞–Ω'}
–°–µ—Ç—Ç–∏–Ω–≥: ${project.setting || 'Forgotten Realms'}
${projectDetails.atmosphericDescription ? `–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: ${projectDetails.atmosphericDescription}` : ''}
${projectDetails.themes ? `–¢–µ–º—ã: ${projectDetails.themes.join(', ')}` : ''}

–ù–û–í–ê–Ø –°–¶–ï–ù–ê:
${sceneContext || '–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Å—Ü–µ–Ω—É –¥–ª—è —ç—Ç–æ–π –∫–∞–º–ø–∞–Ω–∏–∏'}
`.trim();
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. ‚úÖ –õ—É—á—à–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å
–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞–º–ø–∞–Ω–∏–∏ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –∏ –≤–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –æ–±—â–∏–π —Å—é–∂–µ—Ç.

### 2. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞
AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–ª—é–¥–∞–µ—Ç –∑–∞–¥–∞–Ω–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É (–≥–æ—Ç–∏–∫–∞, –∫–æ–º–µ–¥–∏—è, —Ö–æ—Ä—Ä–æ—Ä –∏ —Ç.–¥.)

### 3. ‚úÖ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ NPC
–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏–º–µ—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Å—é–∂–µ—Ç—É, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω—ã–µ NPC.

### 4. ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã
–í—Ä–∞–≥–∏ –∏ –ª–æ–∫–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–º–µ –∫–∞–º–ø–∞–Ω–∏–∏.

### 5. ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –º–∞—Å—Ç–µ—Ä–∞
–ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±—ä—è—Å–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç - AI —É–∂–µ –∑–Ω–∞–µ—Ç –≤—Å—ë –æ –∫–∞–º–ø–∞–Ω–∏–∏.

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–∞–º–ø–∞–Ω–∏—è: "–ö–æ–º–µ–¥–∏–π–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ"
```
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: "–õ—ë–≥–∫–∞—è –∫–æ–º–µ–¥–∏—è –≤ –¥—É—Ö–µ –ú–æ–Ω—Ç–∏ –ü–∞–π—Ç–æ–Ω–∞"

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è NPC:
‚Üí AI —Å–æ–∑–¥–∞—Å—Ç –∑–∞–±–∞–≤–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å —é–º–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ —á–µ—Ä—Ç–∞–º–∏

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–∞:
‚Üí AI —Å–æ–∑–¥–∞—Å—Ç –±–æ–π —Å –∫–æ–º–∏—á–Ω—ã–º–∏ –º–æ–Ω—Å—Ç—Ä–∞–º–∏ –∏ —Å–º–µ—à–Ω—ã–º–∏ —Å–∏—Ç—É–∞—Ü–∏—è–º–∏
```

### –ö–∞–º–ø–∞–Ω–∏—è: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ö–æ—Ä—Ä–æ—Ä"
```
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: "–£–∂–∞—Å—ã –õ–∞–≤–∫—Ä–∞—Ñ—Ç–∞, –¥—Ä–µ–≤–Ω–µ–µ –∑–ª–æ"

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è NPC:
‚Üí AI —Å–æ–∑–¥–∞—Å—Ç –º—Ä–∞—á–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –Ω–∞–º–µ–∫–∞–º–∏ –Ω–∞ –±–µ–∑—É–º–∏–µ

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–∞:
‚Üí AI —Å–æ–∑–¥–∞—Å—Ç –±–æ–π —Å —á—É–¥–æ–≤–∏—â–∞–º–∏ –∏–∑ –∏–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
```

---

## –ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ project.description

`project.description` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ JSON —Å—Ç—Ä–æ–∫–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```json
{
  "themes": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2"],
  "estimatedSessions": 8,
  "recommendedLevel": "10-15",
  "mainPlotPoints": ["—Ç–æ—á–∫–∞ 1", "—Ç–æ—á–∫–∞ 2"],
  "keyLocations": ["–ª–æ–∫–∞—Ü–∏—è 1", "–ª–æ–∫–∞—Ü–∏—è 2"],
  "mainAntagonist": {
    "name": "–ò–º—è",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ"
  },
  "hooks": ["–∑–∞—Ü–µ–ø–∫–∞ 1", "–∑–∞—Ü–µ–ø–∫–∞ 2"],
  "atmosphericDescription": "–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∫–∞–º–ø–∞–Ω–∏–∏"
}
```

–í—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!

---

## –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ö–∞–∫ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–∞–º–ø–∞–Ω–∏—é** (–ø–æ—ç—Ç–∞–ø–Ω–æ –∏–ª–∏ –±—ã—Å—Ç—Ä–æ)
2. **–£–∫–∞–∂–∏—Ç–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É** –≤ –ø–æ–ª–µ "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ"
3. **–ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç** (—Å—Ü–µ–Ω—ã/NPC/—ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã)

AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–∞—à–µ–π –∫–∞–º–ø–∞–Ω–∏–∏!

### –°–æ–≤–µ—Ç—ã:

- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã** ‚Üí AI –ª—É—á—à–µ —Å–æ–±–ª—é–¥–∞–µ—Ç —Å—Ç–∏–ª—å
- ‚úÖ **–£–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–µ–º—ã** ‚Üí AI —Å–æ–∑–¥–∞—Å—Ç –±–æ–ª–µ–µ —Å–≤—è–∑–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- ‚úÖ **–û–ø–∏—Å—ã–≤–∞–π—Ç–µ –∞–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç–∞** ‚Üí NPC –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–≤—è–∑—å —Å –Ω–∏–º

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
- `src/app/api/generate/scene/route.ts`
- `src/app/api/generate/npc/route.ts`
- `src/app/api/generate/encounter/route.ts`

### –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ –ë–î –ø–æ `projectId`
- –ü–∞—Ä—Å–∏–Ω–≥ `project.description` (JSON)
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ `enrichedContext`
- –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç—ã

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –æ—à–∏–±–∫–∞ 404
- ‚úÖ –ï—Å–ª–∏ `description` –ø—É—Å—Ç–æ–π ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

---

**–¢–µ–ø–µ—Ä—å –≤—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–∞—è!** üéØ

–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∫–∞–º–ø–∞–Ω–∏–∏ –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –æ–±—â–∏–π —Å—é–∂–µ—Ç –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.


