# üîß CRUD –û–ø–µ—Ä–∞—Ü–∏–∏ - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –û–±–∑–æ—Ä

–¢–µ–ø–µ—Ä—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π CRUD (Create, Read, Update, Delete) –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π!

## –ß—Ç–æ –¥–æ—Å—Ç—É–ø–Ω–æ

### ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ (Create)
- **–ü—É—Å—Ç–∞—è –∫–∞–º–ø–∞–Ω–∏—è** - —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑ AI
- **–ü—É—Å—Ç–∞—è —Å—Ü–µ–Ω–∞** - –±—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω—ã
- **–ü—É—Å—Ç–æ–π NPC** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤—Ä—É—á–Ω—É—é
- **–ü—É—Å—Ç–æ–π —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä** - —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ—è –≤—Ä—É—á–Ω—É—é

### ‚úÖ –ß—Ç–µ–Ω–∏–µ (Read)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–º–ø–∞–Ω–∏–∏ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (Update)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ API
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ NPC
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–æ–≤

### ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ (Delete)
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω
- –£–¥–∞–ª–µ–Ω–∏–µ NPC
- –£–¥–∞–ª–µ–Ω–∏–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–æ–≤

---

## API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Projects (–ö–∞–º–ø–∞–Ω–∏–∏)

#### –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π –ø—Ä–æ–µ–∫—Ç
```http
POST /api/projects
Content-Type: application/json

{
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
  "setting": "Forgotten Realms"
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
```http
PATCH /api/projects/[id]
Content-Type: application/json

{
  "title": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–ù–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
  "synopsis": "–ù–æ–≤—ã–π —Å–∏–Ω–æ–ø—Å–∏—Å",
  "setting": "–ù–æ–≤—ã–π —Å–µ—Ç—Ç–∏–Ω–≥"
}
```

#### –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
```http
DELETE /api/projects/[id]
```

---

### Scenes (–°—Ü–µ–Ω—ã)

#### –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é —Å—Ü–µ–Ω—É
```http
POST /api/scenes
Content-Type: application/json

{
  "projectId": "project-id",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
  "sceneType": "story|combat|social|exploration"
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å —Å—Ü–µ–Ω—É
```http
PATCH /api/scenes/[id]
Content-Type: application/json

{
  "title": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–ù–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
  "sceneType": "combat",
  "order": 5
}
```

#### –£–¥–∞–ª–∏—Ç—å —Å—Ü–µ–Ω—É
```http
DELETE /api/scenes/[id]
```

---

### NPCs (–ü–µ—Ä—Å–æ–Ω–∞–∂–∏)

#### –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–≥–æ NPC
```http
POST /api/npcs
Content-Type: application/json

{
  "projectId": "project-id",
  "name": "–ò–º—è NPC",
  "race": "Human",
  "npcClass": "Commoner",
  "level": 1,
  "alignment": "Neutral"
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å NPC
```http
PATCH /api/npcs/[id]
Content-Type: application/json

{
  "name": "–ù–æ–≤–æ–µ –∏–º—è",
  "race": "Elf",
  "npcClass": "Wizard",
  "level": 5,
  "personality": "–ú—É–¥—Ä—ã–π –∏ —Å–ø–æ–∫–æ–π–Ω—ã–π",
  "backstory": "–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è...",
  "appearance": "–í–Ω–µ—à–Ω–æ—Å—Ç—å...",
  "motivations": "–ú–æ—Ç–∏–≤–∞—Ü–∏–∏..."
}
```

#### –£–¥–∞–ª–∏—Ç—å NPC
```http
DELETE /api/npcs/[id]
```

---

### Encounters (–≠–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã)

#### –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä
```http
POST /api/encounters
Content-Type: application/json

{
  "projectId": "project-id",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä–∞",
  "encounterType": "combat",
  "difficulty": "medium",
  "estimatedLevel": 3
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä
```http
PATCH /api/encounters/[id]
Content-Type: application/json

{
  "title": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –±–æ—è",
  "difficulty": "hard",
  "monsters": "[{\"name\": \"Goblin\", \"count\": 5}]",
  "environment": "–¢–µ–º–Ω—ã–π –ª–µ—Å",
  "tactics": "–ó–∞—Å–∞–¥–∞ –∏–∑-–∑–∞ –¥–µ—Ä–µ–≤—å–µ–≤"
}
```

#### –£–¥–∞–ª–∏—Ç—å —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä
```http
DELETE /api/encounters/[id]
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ UI

### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

–¢–µ–ø–µ—Ä—å –µ—Å—Ç—å **–¥–≤–∞ —Ä–∞–∑–¥–µ–ª–∞ –≤–∫–ª–∞–¥–æ–∫**:

#### ü§ñ AI –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
- –ö–∞–º–ø–∞–Ω–∏—è (–ü–æ—ç—Ç–∞–ø–Ω–æ) üöÄ
- –ë—ã—Å—Ç—Ä–∞—è –∫–∞–º–ø–∞–Ω–∏—è ‚ö°
- –°—Ü–µ–Ω–∞ (AI) üé¨
- NPC (AI) üé≠
- –≠–Ω–∫–∞—É–Ω—Ç–µ—Ä (AI) ‚öîÔ∏è

#### ‚úã –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
- –ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è üìö
- –ù–æ–≤–∞—è —Å—Ü–µ–Ω–∞ ‚ûï
- –ù–æ–≤—ã–π NPC ‚ûï
- –ù–æ–≤—ã–π —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä ‚ûï

### –§–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è

#### CreateProjectForm
```tsx
<CreateProjectForm onSuccess={() => refetch()} />
```

#### CreateSceneForm
```tsx
<CreateSceneForm 
  projects={projects} 
  onSuccess={() => refetch()} 
/>
```

#### CreateNPCForm
```tsx
<CreateNPCForm 
  projects={projects} 
  onSuccess={() => refetch()} 
/>
```

#### CreateEncounterForm
```tsx
<CreateEncounterForm 
  projects={projects} 
  onSuccess={() => refetch()} 
/>
```

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ConfirmModal
–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è:

```tsx
<ConfirmModal
  isOpen={showConfirm}
  title="–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç?"
  message="–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Å—Ü–µ–Ω—ã, NPC –∏ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã."
  confirmText="–£–¥–∞–ª–∏—Ç—å"
  cancelText="–û—Ç–º–µ–Ω–∞"
  onConfirm={handleDelete}
  onCancel={() => setShowConfirm(false)}
  danger={true}
/>
```

### EditModal
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```tsx
<EditModal
  isOpen={showEdit}
  title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"
  onClose={() => setShowEdit(false)}
>
  <EditProjectForm project={project} onSuccess={handleUpdate} />
</EditModal>
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é –∫–∞–º–ø–∞–Ω–∏—é
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"–ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è"** üìö
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Å–µ—Ç—Ç–∏–Ω–≥
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é –∫–∞–º–ø–∞–Ω–∏—é"**

### 2. –î–æ–±–∞–≤–∏—Ç—å —Å—Ü–µ–Ω—ã –≤—Ä—É—á–Ω—É—é
1. –í—ã–±–µ—Ä–∏—Ç–µ **"–ù–æ–≤–∞—è —Å—Ü–µ–Ω–∞"** ‚ûï
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–º–ø–∞–Ω–∏—é
3. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ç–∏–ø
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é —Å—Ü–µ–Ω—É"**

### 3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—á–µ—Ä–µ–∑ API)
```javascript
// –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã
await fetch(`/api/scenes/${sceneId}`, {
  method: 'PATCH',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    title: '–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã'
  })
});
```

### 4. –£–¥–∞–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
```javascript
const [showConfirm, setShowConfirm] = useState(false);

const handleDelete = async () => {
  await fetch(`/api/projects/${projectId}`, {
    method: 'DELETE'
  });
  setShowConfirm(false);
  refetch();
};

// –í JSX:
<button onClick={() => setShowConfirm(true)}>
  –£–¥–∞–ª–∏—Ç—å
</button>

<ConfirmModal
  isOpen={showConfirm}
  title="–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç?"
  message="–í—ã —É–≤–µ—Ä–µ–Ω—ã?"
  onConfirm={handleDelete}
  onCancel={() => setShowConfirm(false)}
  danger
/>
```

---

## Workflow: AI + –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥:

1. **–°–æ–∑–¥–∞–π—Ç–µ –æ—Å–Ω–æ–≤—É —Å AI:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–ö–∞–º–ø–∞–Ω–∏—è (–ü–æ—ç—Ç–∞–ø–Ω–æ)" –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
   - –ü–æ–ª—É—á–∏—Ç–µ 10 —Å—Ü–µ–Ω + 20-30 NPC

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:**
   - –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ü–µ–Ω—ã (‚ûï –ù–æ–≤–∞—è —Å—Ü–µ–Ω–∞)
   - –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö NPC (‚ûï –ù–æ–≤—ã–π NPC)
   - –î–æ–±–∞–≤—å—Ç–µ –æ—Å–æ–±—ã–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã (‚ûï –ù–æ–≤—ã–π —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä)

3. **–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –¥–µ—Ç–∞–ª–∏:**
   - –ß–µ—Ä–µ–∑ API –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è
   - –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –∏–º–µ–Ω–∞ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
   - –£–¥–∞–ª—è–π—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£–¥–∞–ª–µ–Ω–∏–µ —Å –∫–∞—Å–∫–∞–¥–æ–º
–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è**:
- ‚úÖ –í—Å–µ —Å—Ü–µ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –í—Å–µ NPC –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –í—Å–µ —ç–Ω–∫–∞—É–Ω—Ç–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—ç—Ç–æ–º—É:** –í—Å–µ–≥–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–π—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `ConfirmModal`!

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:
- üìù –ò–Ω–ª–∞–π–Ω-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞
- üîÑ Drag & drop –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ —Å—Ü–µ–Ω
- üìã –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω/NPC –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- üóÇÔ∏è –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º!** ‚ú®

–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å AI –∏–ª–∏ –≤—Ä—É—á–Ω—É—é, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∫ —Ö–æ—Ç–∏—Ç–µ, —É–¥–∞–ª—è–π—Ç–µ —á—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ!


