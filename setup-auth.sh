#!/bin/bash

echo "============================================"
echo "   Настройка системы авторизации"
echo "============================================"
echo ""

echo "[1/3] Применение миграции базы данных..."
npx prisma db push
if [ $? -ne 0 ]; then
    echo "ОШИБКА: Не удалось применить миграцию"
    exit 1
fi
echo ""

echo "[2/3] Генерация Prisma Client..."
npx prisma generate
if [ $? -ne 0 ]; then
    echo "ОШИБКА: Не удалось сгенерировать Prisma Client"
    exit 1
fi
echo ""

echo "[3/3] Заполнение базы данных (создание пользователей)..."
npm run db:seed
if [ $? -ne 0 ]; then
    echo "ОШИБКА: Не удалось заполнить базу данных"
    exit 1
fi
echo ""

echo "============================================"
echo "   Настройка завершена успешно!"
echo "============================================"
echo ""
echo "Создан пользователь администратора:"
echo "  Логин: admin"
echo "  Пароль: admpass123"
echo ""
echo "Создан демо-пользователь:"
echo "  Логин: demo"
echo "  Пароль: demo"
echo ""
echo "Теперь вы можете запустить приложение:"
echo "  npm run dev"
echo ""

